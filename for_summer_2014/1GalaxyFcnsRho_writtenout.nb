(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    111770,       2923]
NotebookOptionsPosition[    109605,       2843]
NotebookOutlinePosition[    109957,       2859]
CellTagsIndexPosition[    109914,       2856]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Functions for Nuker model galaxies, using density \[Rho](r) not I(R)\
\>", "Title",
 CellChangeTimes->{{3.608309530235087*^9, 3.6083095473832483`*^9}, {
  3.6083108751227913`*^9, 3.608310889764687*^9}, {3.608397565946055*^9, 
  3.608397568561994*^9}}],

Cell[CellGroupData[{

Cell["Functional forms", "Section",
 CellChangeTimes->{{3.608309982246256*^9, 3.608309985189455*^9}}],

Cell[CellGroupData[{

Cell["\<\
Calculate the basic parameters for a Nuker fit galaxy, given the observed \
quantities\
\>", "Subsection",
 CellChangeTimes->{{3.608309565047134*^9, 3.60830959184587*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makemodel", "[", 
    RowBox[{
    "modelname_", ",", "\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_", ",", 
     "r0pc_", ",", "\[Rho]0_", ",", "MBHomsun_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "MBHnorm", ",", "rT", ",", "r0orT", ",", "tdyn0", ",", "sigmabsqokmps2",
        ",", "fscale", ",", "\n", "\t", 
       RowBox[{"G", "=", " ", 
        RowBox[{"6.67259", " ", 
         RowBox[{"10", "^", 
          RowBox[{"-", "8"}]}]}]}], ",", 
       RowBox[{"msun", "=", "1"}], ",", 
       RowBox[{"realmsun", "=", 
        RowBox[{"1.989", " ", 
         RowBox[{"10", "^", "33"}]}]}], ",", 
       RowBox[{"pc", "=", "1"}], ",", 
       RowBox[{"realpc", "=", 
        RowBox[{"3.0857", " ", 
         RowBox[{"10", "^", "18"}]}]}], ",", 
       RowBox[{"rsun", "=", 
        RowBox[{"6.9599", " ", 
         RowBox[{"10", "^", "10"}]}]}]}], "}"}], ",", "\n", " ", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{"r0pc", " ", "is", " ", "in", " ", "pc"}], " ", "*)"}], "\n", 
     RowBox[{"(*", " ", 
      RowBox[{"rho0", " ", "is", " ", "in", " ", 
       RowBox[{"Msun", "/", 
        RowBox[{"pc", "^", "3"}]}]}], " ", "*)"}], "\n", "\n", "\t", 
     RowBox[{
      RowBox[{"MBHnorm", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MBHomsun", " ", "msun"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"\[Rho]0", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r0pc", " ", "pc"}], ")"}], "^", "3"}]}], ")"}]}]}], ";", 
      "\n", "\t", 
      RowBox[{"rT", "=", 
       RowBox[{"rsun", " ", 
        RowBox[{
         RowBox[{"(", "MBHomsun", ")"}], "^", 
         RowBox[{"(", 
          RowBox[{"1", "/", "3"}], ")"}]}]}]}], ";", "\n", "\t", 
      RowBox[{"r0orT", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r0pc", " ", "realpc"}], ")"}], "/", "rT"}]}], ";", "\n", 
      "\n", "\t", 
      RowBox[{"tdyn0", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"G", " ", "\[Rho]0", " ", 
          RowBox[{"realmsun", "/", 
           RowBox[{"realpc", "^", "3"}]}]}], ")"}], "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ")"}]}]}], ";", "\n", "\t", "\n", 
      "\t", 
      RowBox[{"sigmabsqokmps2", "=", 
       RowBox[{"G", " ", "\[Rho]0", " ", 
        RowBox[{"r0pc", "^", "2"}], " ", 
        RowBox[{
         RowBox[{"realmsun", " ", "/", " ", "realpc"}], " ", "/", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"10", "^", "5"}], ")"}], "^", "2"}]}]}]}], " ", ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"sigma", "^", "2"}], " ", "scale", " ", "at", " ", "r0", " ", 
        "in", " ", "units", " ", "of", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"km", "/", "s"}], ")"}], "^", "2"}]}], " ", "*)"}], "\n", 
      "\t", 
      RowBox[{"fscale", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"G", "^", "3"}], " ", "\[Rho]0", " ", 
            RowBox[{"realmsun", "/", 
             RowBox[{"realpc", "^", "3"}]}]}], "]"}], " ", "realmsun", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"r0pc", " ", "realpc"}], ")"}], "^", "3"}]}], ")"}], "^", 
        
        RowBox[{"-", "1"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"freal", " ", "=", " ", 
        RowBox[{"fdimensionless", " ", "*", " ", "fscale"}]}], " ", "*)"}], 
      "\n", "\n", "\t", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Gives", " ", "galaxy", " ", "name"}], ",", " ", "\[Alpha]", 
        ",", " ", "\[Beta]", ",", " ", "\[CapitalGamma]", ",", " ", 
        RowBox[{"MBH", "/", "msun"}], ",", " ", 
        RowBox[{"MBH", " ", "normalized", " ", "to", " ", "\[Rho]0", " ", 
         RowBox[{"r0", "^", "3"}]}], ",", " ", 
        RowBox[{"r0", "/", "rT"}], ",", " ", 
        RowBox[{"r0", "/", "pc"}], ",", " ", 
        RowBox[{"tdyn", " ", "at", " ", "r0"}]}], " ", "*)"}], "\n", "\t", 
      RowBox[{"{", 
       RowBox[{
       "modelname", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", 
        "MBHomsun", ",", "MBHnorm", ",", "r0orT", ",", "r0pc", ",", "tdyn0", 
        ",", "\[Rho]0", ",", "sigmabsqokmps2", ",", "fscale"}], "}"}]}]}], 
    "\n", "]"}]}], "\[IndentingNewLine]", "\n"}]], "Input",
 CellChangeTimes->{{3.568558797556725*^9, 3.568558803552553*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functional forms for the density distribution and derivatives, assuming a \
power-law\
\>", "Subsection",
 CellChangeTimes->{{3.608309601213937*^9, 3.608309606573599*^9}, {
  3.6083097569002743`*^9, 3.608309772618935*^9}, {3.608309829338043*^9, 
  3.6083098337222357`*^9}, {3.608309937776059*^9, 3.608309940383239*^9}}],

Cell["\<\
Check this to see whether we want to use I(R) or  \[Rho](r); this notebook \
does \[Rho](r).\
\>", "Text",
 CellChangeTimes->{{3.608309780427455*^9, 3.608309797474298*^9}, {
  3.608397572569973*^9, 3.608397573120553*^9}, {3.608479243378916*^9, 
  3.6084792692874928`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Rho]", "[", "r_", "]"}], ":=", 
    RowBox[{
     RowBox[{"r", "^", 
      RowBox[{"-", "\[Gamma]"}]}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"r", "^", "\[Alpha]"}]}], ")"}], "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]", "-", "\[Beta]"}], ")"}], "/", "\[Alpha]"}], 
       ")"}]}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"d\[Rho]dr", "[", "r_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"r", "^", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "-", "\[Gamma]"}], ")"}]}]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"r", "^", "\[Alpha]"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "+", "\[Beta]", "-", "\[Gamma]"}], ")"}], "/", 
         "\[Alpha]"}], ")"}]}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "^", "\[Alpha]"}], " ", "\[Beta]"}], "+", "\[Gamma]"}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"d2\[Rho]dr2", "[", "r_", "]"}], ":=", 
   RowBox[{
    RowBox[{"r", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "-", "\[Gamma]"}], ")"}]}], " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"r", "^", "\[Alpha]"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "\[Alpha]"}], "-", "\[Beta]", "+", 
         "\[Gamma]"}], ")"}], "/", "\[Alpha]"}], ")"}]}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"r", "^", 
        RowBox[{"(", 
         RowBox[{"2", " ", "\[Alpha]"}], ")"}]}], " ", "\[Beta]", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "\[Beta]"}], ")"}]}], "+", "\[Gamma]", "+", 
      RowBox[{"\[Gamma]", "^", "2"}], "+", 
      RowBox[{
       RowBox[{"r", "^", "\[Alpha]"}], " ", 
       RowBox[{"(", 
        RowBox[{"\[Beta]", "-", 
         RowBox[{"\[Alpha]", " ", "\[Beta]"}], "+", "\[Gamma]", "+", 
         RowBox[{"\[Alpha]", " ", "\[Gamma]"}], "+", 
         RowBox[{"2", " ", "\[Beta]", " ", "\[Gamma]"}]}], ")"}]}]}], 
     ")"}]}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functional forms for the enclosed mass and galaxy potential\
\>", "Subsection",
 CellChangeTimes->{{3.608309847905444*^9, 3.608309862432293*^9}, {
  3.6083099426794243`*^9, 3.608309945782255*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Menc", "[", "r_", "]"}], ":=", 
    RowBox[{"4", "\[Pi]", " ", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Rho]", "[", "p", "]"}], " ", 
        RowBox[{"p", "^", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"p", ",", "0", ",", "r"}], "}"}]}], "]"}]}]}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]part2", "[", "r_", "]"}], ":=", 
     RowBox[{"4", "\[Pi]", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"\[Rho]", "[", "p", "]"}], " ", "p"}], ",", 
        RowBox[{"{", 
         RowBox[{"p", ",", "r", ",", "\[Infinity]"}], "}"}]}], "]"}]}]}], 
    ";"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]part2", "[", "r_", "]"}], ":=", 
  RowBox[{"4", "\[Pi]", " ", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Rho]", "[", 
       RowBox[{"Exp", "[", "lp", "]"}], "]"}], 
      RowBox[{"Exp", "[", 
       RowBox[{"2", "lp"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"lp", ",", 
       RowBox[{"Log", "[", "r", "]"}], ",", "Infinity"}], "}"}]}], 
    "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]", "[", "r_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", " ", "MBHnorm", ")"}], "/", "r"}], "+", 
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{"Menc", "[", "r", "]"}], ")"}], "/", "r"}], "+", " ", 
    RowBox[{"\[Psi]part2", "[", "r", "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5685587332387047`*^9, 3.5685587346033897`*^9}, {
   3.608306727668459*^9, 3.608306730072521*^9}, {3.6083073115706997`*^9, 
   3.608307337937882*^9}, 3.608309821534461*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functional forms for the radius of apocenter & circular angular momentum \
squared\
\>", "Subsection",
 CellChangeTimes->{{3.608309880088605*^9, 3.6083099082083683`*^9}, {
  3.608309947639106*^9, 3.608309950015183*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rapo", "[", 
     RowBox[{"E_", ",", "\[Psi]good_"}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "r", "}"}], ",", "\n", "\t", 
      RowBox[{"r", "/.", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Psi]good", "[", "r", "]"}], "==", "E"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"-", "2"}]}], " ", 
            RowBox[{"E", "^", 
             RowBox[{"-", "1"}]}]}]}], "}"}]}], "]"}]}]}], " ", "\n", "]"}]}],
    "\n", "\n", 
   RowBox[{
    RowBox[{"Jc2", "[", 
     RowBox[{"E_", ",", "Mencgood_", ",", "\[Psi]good_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rcircval", ",", "ans"}], "}"}], ",", "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"rcircval", "=", 
         RowBox[{"r", "/.", 
          RowBox[{"Quiet", "[", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{"E", "==", 
              RowBox[{
               RowBox[{"\[Psi]good", "[", "r", "]"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Mencgood", "[", "r", "]"}], "+", "MBHnorm"}], 
                  ")"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", "r"}], ")"}]}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", 
               RowBox[{"E", "^", 
                RowBox[{"-", "1"}]}]}], "}"}]}], "]"}], "]"}]}]}], ";"}], " ",
        "*)"}], "\n", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"rcircval", "=", 
         RowBox[{"r", "/.", 
          RowBox[{"Quiet", "[", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{"E", "==", 
              RowBox[{
               RowBox[{"\[Psi]good", "[", "r", "]"}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Mencgood", "[", "r", "]"}], "+", "MBHnorm"}], 
                  ")"}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"2", "r"}], ")"}]}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"r", ",", "rcircvalguess"}], "}"}]}], "]"}], "]"}]}]}], 
        ";"}], " ", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"rcircval", "=", 
        RowBox[{"r", "/.", 
         RowBox[{"Quiet", "[", 
          RowBox[{"FindRoot", "[", 
           RowBox[{
            RowBox[{"E", "==", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Mencgood", "[", "r", "]"}], "+", "MBHnorm"}], 
                 ")"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "r"}], ")"}]}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"r", ",", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"-", "2"}]}], " ", 
               RowBox[{"E", "^", 
                RowBox[{"-", "1"}]}]}]}], "}"}]}], "]"}], "]"}]}]}], ";", 
       "\n", 
       RowBox[{"(*", " \t", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<E=\>\"", ",", "E", ",", "\"\<, rcircval = \>\"", ",", " ", 
           "rcircval"}], "]"}], ";"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"ans", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Mencgood", "[", "rcircval", "]"}], "+", "MBHnorm"}], 
          ")"}], "rcircval"}]}], ";", "\n", "\t", "ans"}]}], "]"}]}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"for", " ", "some", " ", "reason"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{
       "Jc2", " ", "can", " ", "kind", " ", "of", " ", "get", " ", "stuck", 
        " ", "when", " ", "E", " ", "is", " ", "too", " ", "large", " ", 
        "and", " ", "the", " ", "guess", " ", "for", " ", "rcircval", " ", 
        "becomes", " ", "bad"}], "..."}], "\n", "note", " ", 
      RowBox[{"it", "'"}], "s", " ", "not", " ", "that", " ", "\[Psi]good", 
      " ", "complains", " ", "for", " ", "small", " ", 
      RowBox[{"r", ".", " ", 
       RowBox[{"it", "'"}]}], "s", " ", "just", " ", "the", " ", "guess", " ",
       "for", " ", 
      RowBox[{"rcircval", "."}]}]}], "  ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.568558743914816*^9, 3.568558744257443*^9}, 
   3.608309867959618*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functional forms for g and mathcal G;
mathcalG has a lot of explicit convergence checking in it. we should test \
which are best ways to do the calculation and ultimately clean this up.\
\>", "Subsection",
 CellChangeTimes->{{3.6083099229998093`*^9, 3.6083099556789217`*^9}, {
  3.608479293906411*^9, 3.6084793686940203`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", 
    RowBox[{"E_", ",", "\[Psi]good_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rapoval", ",", "gans"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"rapoval", "=", 
       RowBox[{"rapo", "[", 
        RowBox[{"E", ",", "\[Psi]good"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"gans", "=", 
       RowBox[{
        RowBox[{"-", "\[Pi]"}], " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"d\[Rho]dr", "[", 
             RowBox[{"1", "/", "u"}], "]"}], "/", 
            RowBox[{"u", "^", "2"}]}], " ", 
           RowBox[{"1", "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"E", "-", 
              RowBox[{"\[Psi]good", "[", 
               RowBox[{"1", "/", "u"}], "]"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "0", ",", "0", ",", 
            RowBox[{"1", "/", "rapoval"}], ",", 
            RowBox[{"1", "/", "rapoval"}]}], "}"}], ",", 
          RowBox[{"MaxRecursion", "->", "20"}]}], "]"}]}]}], ";", "\n", "\t", 
      
      RowBox[{"Re", "[", "gans", "]"}]}]}], "\n", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mathcalG", "[", 
   RowBox[{"E_", ",", "\[Psi]good_", ",", "ggood_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rapoval", ",", "ans1", ",", "ans2", ",", "ans1testa", ",", "ans1testb", 
      ",", "ans2testa", ",", "ans2testb", ",", "ans1ratio", ",", "ans2ratio", 
      ",", 
      RowBox[{"eps1", "=", 
       RowBox[{"10", "^", 
        RowBox[{"-", "3"}]}]}], ",", "eps2", ",", "time1", ",", "time2", ",", 
      "time3"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{"rapoval", "=", 
      RowBox[{"rapo", "[", 
       RowBox[{"E", ",", "\[Psi]good"}], "]"}]}], ";", "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<rapoval \>\"", ",", " ", "rapoval"}], "]"}], ";"}], " ", 
      "*)"}], "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"ans1", " ", "=", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
           RowBox[{"ggood", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
             RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
           "}"}], ",", 
          RowBox[{"MaxRecursion", "->", "5"}], ",", 
          RowBox[{"AccuracyGoal", "->", "3"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans1\>\"", ",", "ans1"}], "]"}], ";", "\t ", "\n", "\t", 
       
       RowBox[{"ans2", " ", "=", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
           RowBox[{"ggood", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
             RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
           "}"}], ",", 
          RowBox[{"MaxRecursion", "->", "5"}], ",", 
          RowBox[{"AccuracyGoal", "->", "3"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans2\>\"", ",", "ans2"}], "]"}], ";"}], "\t", "\n", 
      "*)"}], "\n", "\n", "\t", 
     RowBox[{"time2", " ", "=", " ", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<E = \>\"", ",", " ", "E"}], "]"}], ";", "\n", "\t", 
     RowBox[{"eps2", " ", "=", " ", 
      RowBox[{"eps1", "/", "10"}]}], ";", "\n", "\t", 
     RowBox[{"ans1", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
         RowBox[{"ggood", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
           RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "eps2", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
         "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ans1ratio", " ", "=", " ", 
        RowBox[{"ans1testa", "/", "ans1"}]}], ";"}], " ", "*)"}], "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"ans1ratio", " ", "=", " ", 
        RowBox[{"ans1testa", "/", "ans1testb"}]}], ";"}], " ", "*)"}], "\n", 
     RowBox[{"(*", " \t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans1 ratio = \>\"", ",", "ans1ratio"}], "]"}], ";"}], 
      " ", "*)"}], "\n", "\t", 
     RowBox[{"ans2", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
         RowBox[{"ggood", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
           RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "eps2", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
         "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ans2ratio", " ", "=", " ", 
        RowBox[{"ans2testa", "/", "ans2"}]}], ";"}], " ", "*)"}], "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"ans2ratio", " ", "=", " ", 
        RowBox[{"ans2testa", "/", "ans2testb"}]}], ";"}], " ", "*)"}], "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans2 ratio = \>\"", ",", "ans2ratio"}], "]"}], ";"}], 
      " ", "*)"}], "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Log", "[", "ans1ratio", "]"}], "]"}], ",", " ", 
         "\"\<, \>\"", ",", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{"Log", "[", "ans2ratio", "]"}], "]"}]}], "]"}], ";"}], " ", 
      "*)"}], "\n", "\n", "\t", 
     RowBox[{"time3", " ", "=", " ", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<time for eps method = \>\"", ",", " ", 
       RowBox[{"time3", "-", "time2"}]}], "]"}], ";", "\n", "\n", "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"time1", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
       RowBox[{"ans1testb", " ", "=", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
           RowBox[{"ggood", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
             RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
           "}"}], ",", 
          RowBox[{"Method", "->", "\"\<MonteCarlo\>\""}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans1 = \>\"", ",", 
         RowBox[{"ans1testb", "/", "ans1testa"}]}], "]"}], ";", "\t ", "\n", 
       "\t", 
       RowBox[{"ans2testb", " ", "=", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
           RowBox[{"ggood", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
             RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
           "}"}], ",", 
          RowBox[{"Method", "->", "\"\<MonteCarlo\>\""}]}], "]"}]}], ";", 
       "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans2 = \>\"", ",", 
         RowBox[{"ans2testb", "/", "ans2testa"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"time2", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<time for MC = \>\"", ",", " ", 
         RowBox[{"time2", "-", "time1"}]}], "]"}], ";", "\n", "\n", "\t", 
       RowBox[{"ans1testb", " ", "=", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
           RowBox[{"ggood", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
             RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
           "}"}], ",", 
          RowBox[{"Method", "->", "\"\<QuasiMonteCarlo\>\""}]}], "]"}]}], ";",
        "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans1 = \>\"", ",", 
         RowBox[{"ans1testb", "/", "ans1testa"}]}], "]"}], ";", "\t ", "\n", 
       "\t", 
       RowBox[{"ans2testb", " ", "=", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
           RowBox[{"ggood", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
             RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
           "}"}], ",", 
          RowBox[{"Method", "->", "\"\<QuasiMonteCarlo\>\""}]}], "]"}]}], ";",
        "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans2 = \>\"", ",", 
         RowBox[{"ans2testb", "/", "ans2testa"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"time2", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<time for MC = \>\"", ",", " ", 
         RowBox[{"time2", "-", "time1"}]}], "]"}], ";"}], " ", "*)"}], "\n", 
     "\n", 
     RowBox[{"(*", "\t", 
      RowBox[{
       RowBox[{"time1", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
       RowBox[{"ans1testb", " ", "=", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
           RowBox[{"ggood", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
             RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
           "}"}], ",", 
          RowBox[{"Method", "->", "\"\<TrapezoidalRule\>\""}]}], "]"}]}], ";",
        "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans1 = \>\"", ",", 
         RowBox[{"ans1testb", "/", "ans1"}]}], "]"}], ";", "\t ", "\n", "\t", 
       
       RowBox[{"ans2testb", " ", "=", " ", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"r", "^", "2"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
           RowBox[{"ggood", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]good", "[", "r", "]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
             RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
           "}"}], ",", 
          RowBox[{"Method", "->", "\"\<TrapezoidalRule\>\""}]}], "]"}]}], ";",
        "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<ans2 = \>\"", ",", 
         RowBox[{"ans2testb", "/", "ans2"}]}], "]"}], ";", "\n", "\t", 
       RowBox[{"time2", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<time for 1 = \>\"", ",", " ", 
         RowBox[{"time2", "-", "time1"}]}], "]"}], ";"}], "\n", "*)"}], "\n", 
     "\n", "\t", 
     RowBox[{"time1", " ", "=", " ", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
     RowBox[{"ans1testb", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
         RowBox[{"ggood", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
           RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
         "}"}], ",", 
        RowBox[{"Method", "->", "\"\<MonteCarlo\>\""}]}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ans1 ratio = \>\"", ",", 
       RowBox[{"ans1testb", "/", "ans1"}]}], "]"}], ";", "\t ", "\n", "\t", 
     RowBox[{"ans2testb", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
         RowBox[{"ggood", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
           RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
         "}"}], ",", 
        RowBox[{"Method", "->", "\"\<MonteCarlo\>\""}]}], "]"}]}], ";", "\n", 
     "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ans2 ratio = \>\"", ",", 
       RowBox[{"ans2testb", "/", "ans2"}]}], "]"}], ";", "\n", "\t", 
     RowBox[{"time2", " ", "=", " ", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<time for 2 = \>\"", ",", " ", 
       RowBox[{"time2", "-", "time1"}]}], "]"}], ";", "\n", "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<E = \>\"", ",", " ", "E"}], "]"}], ";", "\n", "\t", 
     RowBox[{"eps2", " ", "=", " ", 
      RowBox[{"eps1", "/", "10"}]}], ";", "\n", "\t", 
     RowBox[{"ans1testa", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
         RowBox[{"ggood", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
           RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "eps1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
         "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"ans1", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
         RowBox[{"ggood", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
           RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "eps2", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
         "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ans1ratio", " ", "=", " ", 
        RowBox[{"ans1testa", "/", "ans1"}]}], ";"}], " ", "*)"}], "\n", "\t", 
     
     RowBox[{"ans1ratio", " ", "=", " ", 
      RowBox[{"ans1testb", "/", "ans1testa"}]}], ";", "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ans1 ratio = \>\"", ",", "ans1ratio"}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"ans2testa", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
         RowBox[{"ggood", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
           RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "eps1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
         "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"ans2", " ", "=", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"r", "^", "2"}], "/", 
          RowBox[{"Sqrt", "[", 
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], "-", "E"}], "]"}]}], " ", 
         RowBox[{"ggood", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Psi]good", "[", "r", "]"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Theta]"}], ")"}]}], "+", 
           RowBox[{"E", " ", "\[Theta]"}]}], "]"}], 
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"Sqrt", "[", "\[Theta]", "]"}]}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "eps2", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"r", ",", "0", ",", "0", ",", "rapoval", ",", "rapoval"}], 
         "}"}]}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"ans2ratio", " ", "=", " ", 
        RowBox[{"ans2testa", "/", "ans2"}]}], ";"}], " ", "*)"}], "\n", "\t", 
     
     RowBox[{"ans2ratio", " ", "=", " ", 
      RowBox[{"ans2testb", "/", "ans2testa"}]}], ";", "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<ans2 ratio = \>\"", ",", "ans2ratio"}], "]"}], ";", "\n", 
     "\t", 
     RowBox[{"Print", "[", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"Log", "[", "ans1ratio", "]"}], "]"}], ",", " ", "\"\<, \>\"",
        ",", " ", 
       RowBox[{"Abs", "[", 
        RowBox[{"Log", "[", "ans2ratio", "]"}], "]"}]}], "]"}], ";", "\n", 
     "\n", "\t", 
     RowBox[{"time3", " ", "=", " ", 
      RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\n", "\t", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<time for eps method = \>\"", ",", " ", 
       RowBox[{"time3", "-", "time2"}]}], "]"}], ";", "\n", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Log", "[", "ans1ratio", "]"}], "]"}], ">", "3"}], " ", "||", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"Log", "[", "ans2ratio", "]"}], "]"}], ">", "3"}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<MathcalG not well converged:  ans1ratio = \>\"", ",", " ", 
         "ans1ratio", ",", " ", "\"\<, ans2ratio = \>\"", ",", " ", 
         "ans2ratio"}], "]"}]}], "]"}], ";", "\n", "\n", "\n", "\t", 
     RowBox[{"Re", "[", 
      RowBox[{"ans1", "+", "ans2"}], "]"}]}]}], "\n", "]"}]}]}], "Input",
 CellChangeTimes->{{3.568558987770883*^9, 3.568558989568138*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Functional form for f (the distribution function)\
\>", "Subsection",
 CellChangeTimes->{{3.6083100320292997`*^9, 3.608310040956872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"E_", ",", "Mencgood_", ",", "\[Psi]good_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rapoval", ",", "prefactor", ",", "theintegral1", ",", " ", 
       "theintegral2", ",", " ", "theintegral3", ",", " ", "theintegral3comp",
        ",", " ", 
       RowBox[{"eps", "=", 
        RowBox[{"10", "^", 
         RowBox[{"-", "7"}]}]}], ",", " ", "print1", ",", " ", "print2", ",", 
       " ", "print3", ",", " ", "fans"}], "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"rapoval", "=", 
       RowBox[{"rapo", "[", 
        RowBox[{"E", ",", "\[Psi]good"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", "\t", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<rapoval = \>\"", ",", " ", "rapoval"}], "]"}], ";"}], 
       " ", "*)"}], "\n", "\t", 
      RowBox[{"prefactor", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sqrt", "[", "8", "]"}], " ", 
           RowBox[{"\[Pi]", "^", "2"}]}], ")"}]}], " ", 
        RowBox[{
         RowBox[{"rapoval", "^", "2"}], "/", 
         RowBox[{"(", " ", 
          RowBox[{"MBHnorm", " ", "+", "  ", 
           RowBox[{"Mencgood", "[", "rapoval", "]"}]}], ")"}]}]}]}], ";", 
      "\n", "\t", 
      RowBox[{"theintegral1", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"u", "^", "2"}]}], " ", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"E", "-", 
             RowBox[{"\[Psi]good", "[", 
              RowBox[{"rapoval", "/", "u"}], "]"}]}], "]"}]}], " ", "\n", 
          "\t\t", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rapoval", "/", "u"}], " ", 
            RowBox[{"d2\[Rho]dr2", "[", 
             RowBox[{"rapoval", "/", "u"}], "]"}]}], ")"}]}], ",", "\n", 
         "\t\t", 
         RowBox[{"{", 
          RowBox[{"u", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"MaxRecursion", "->", "20"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"theintegral2", "=", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"u", "^", "2"}]}], " ", 
          RowBox[{"1", "/", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"E", "-", 
             RowBox[{"\[Psi]good", "[", 
              RowBox[{"rapoval", "/", "u"}], "]"}]}], "]"}]}], " ", "\n", 
          "\t\t", 
          RowBox[{"(", 
           RowBox[{"d\[Rho]dr", "[", 
            RowBox[{"rapoval", "/", "u"}], "]"}], ")"}]}], ",", "\n", "\t\t", 
         
         RowBox[{"{", 
          RowBox[{"u", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
         RowBox[{"MaxRecursion", "->", "20"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{"theintegral3", "=", 
       RowBox[{"-", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"u", "^", "2"}]}], " ", 
           RowBox[{"1", "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"E", "-", 
              RowBox[{"\[Psi]good", "[", 
               RowBox[{"rapoval", "/", "u"}], "]"}]}], "]"}]}], " ", "\n", 
           "\t\t", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"(", 
               RowBox[{"2", " ", "rapoval"}], ")"}]}], " ", 
             RowBox[{"d\[Rho]dr", "[", 
              RowBox[{"rapoval", "/", "u"}], "]"}], " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MBHnorm", " ", 
                 RowBox[{"(", 
                  RowBox[{"u", "-", "1"}], ")"}]}], "+", 
                RowBox[{"u", " ", 
                 RowBox[{"Mencgood", "[", 
                  RowBox[{"rapoval", "/", "u"}], "]"}]}], "-", 
                RowBox[{"Mencgood", "[", "rapoval", "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"E", "-", 
                RowBox[{"\[Psi]good", "[", 
                 RowBox[{"rapoval", "/", "u"}], "]"}]}], ")"}]}]}], ")"}]}], 
          ",", "\n", "\t\t", 
          RowBox[{"{", 
           RowBox[{"u", ",", "eps", ",", 
            RowBox[{"1", "-", "eps"}]}], "}"}]}], "]"}]}]}], ";", "\n", 
      RowBox[{"(*", "\t", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<next\>\"", "]"}], ";", "\n", "\t", 
        RowBox[{"theintegral3comp", "=", 
         RowBox[{"-", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"u", "^", "2"}]}], " ", 
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"E", "-", 
                RowBox[{"\[Psi]good", "[", 
                 RowBox[{"rapoval", "/", "u"}], "]"}]}], "]"}]}], " ", "\n", 
             "\t\t", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"(", 
                 RowBox[{"2", " ", "rapoval"}], ")"}]}], " ", 
               RowBox[{"d\[Rho]dr", "[", 
                RowBox[{"rapoval", "/", "u"}], "]"}], " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"MBHnorm", " ", 
                   RowBox[{"(", 
                    RowBox[{"u", "-", "1"}], ")"}]}], "+", 
                  RowBox[{"u", " ", 
                   RowBox[{"Mencgood", "[", 
                    RowBox[{"rapoval", "/", "u"}], "]"}]}], "-", 
                  RowBox[{"Mencgood", "[", "rapoval", "]"}]}], ")"}], "/", 
                RowBox[{"(", 
                 RowBox[{"E", "-", 
                  RowBox[{"\[Psi]good", "[", 
                   RowBox[{"rapoval", "/", "u"}], "]"}]}], ")"}]}]}], ")"}]}],
             ",", "\n", "\t\t", 
            RowBox[{"{", 
             RowBox[{"u", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}], 
           "]"}]}]}], ";"}], "\n", "*)"}], "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{"Method", "->", "\"\<AdaptiveMonteCarlo\>\""}], " ", "*)"}], 
      "\n", 
      RowBox[{"(*", " ", 
       RowBox[{"MaxRecursion", "->", " ", "20"}], " ", "*)"}], "\n", "\n", 
      RowBox[{"(*", "\t", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"E", ",", " ", "\"\<,   \>\"", ",", " ", 
          RowBox[{"theintegral3", "/", "theintegral3comp"}]}], "]"}], ";"}], 
       "\t\t ", "*)"}], "\n", "\n", 
      RowBox[{"(*", "\t", "\n", "\t", 
       RowBox[{
        RowBox[{"print1", "=", "0"}], ";", "\n", "\t", 
        RowBox[{"print2", "=", "0"}], ";", "\n", "\t", 
        RowBox[{"print3", "=", "0"}], ";", "\n", "\n", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"theintegral1", ",", " ", "\"\<  \>\"", ",", " ", 
            RowBox[{"Head", "[", "theintegral1", "]"}]}], "]"}], ";"}], " ", 
         "*)"}], "\n", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "theintegral1", "]"}], "==", "Real"}], "||", 
           
           RowBox[{
            RowBox[{"Head", "[", "theintegral1", "]"}], "==", "Complex"}]}], 
          ",", 
          RowBox[{"print1", "=", "theintegral1"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "theintegral2", "]"}], "==", "Real"}], "||", 
           
           RowBox[{
            RowBox[{"Head", "[", "theintegral2", "]"}], "==", "Complex"}]}], 
          ",", 
          RowBox[{"print2", "=", "theintegral2"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "theintegral3", "]"}], "==", "Real"}], "||", 
           
           RowBox[{
            RowBox[{"Head", "[", "theintegral3", "]"}], "==", "Complex"}]}], 
          ",", 
          RowBox[{"print3", "=", "theintegral3"}]}], "]"}], ";", "\n", "\n", 
        "\t", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<prefactor = \>\"", ",", "prefactor", ",", 
          "\"\<, the integral1 = \>\"", ",", " ", "print1", ",", " ", 
          "\"\<, the integral2 = \>\"", ",", " ", "print2", ",", " ", 
          "\"\<, the integral3 = \>\"", ",", " ", "print3"}], "]"}], ";"}], 
       "\n", "*)"}], "\n", "\n", "\n", "\t", 
      RowBox[{"fans", "=", 
       RowBox[{"prefactor", " ", 
        RowBox[{"(", 
         RowBox[{
         "theintegral1", " ", "+", " ", "theintegral2", " ", "+", " ", 
          "theintegral3"}], ")"}]}]}], ";", "\n", "\n", "\n", "\t", 
      RowBox[{"Re", "[", "fans", "]"}]}]}], "\n", "]"}]}], "\n", "\n", 
  "\n"}]], "Input",
 CellChangeTimes->{{3.5685590087825613`*^9, 3.568559028106009*^9}, {
   3.568559747048715*^9, 3.568559774154688*^9}, 3.608310643997159*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Below are the \[OpenCurlyDoubleQuote]good\[CloseCurlyDoubleQuote] functions. \
\
\>", "Section",
 CellChangeTimes->{{3.608310659833453*^9, 3.6083107107988367`*^9}, {
  3.608479395536234*^9, 3.60847941576101*^9}, {3.608479525033222*^9, 
  3.60847958761521*^9}, {3.608479710163945*^9, 3.608479717699896*^9}}],

Cell[TextData[{
 "The \[OpenCurlyDoubleQuote]good\[CloseCurlyDoubleQuote] functions (i.e., \
functions with names like \[Psi]good) evaluate the functional forms above  \
(e.g., for \[Psi]) on a grid, and then interpolate and extend to smaller and \
larger values using power-law approximations.  We do this because it takes \
too long / gives ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " problems to do the multi-variable integrals in real time, so we can \
tabulate their values beforehand for an individual galaxy and then \
interpolate, and can give those \[OpenCurlyDoubleQuote]good\
\[CloseCurlyDoubleQuote] functions to other functions as their integrands."
}], "Subsection",
 CellChangeTimes->{{3.608479722986876*^9, 3.608479783774374*^9}}],

Cell[TextData[{
 "Some of these have points that ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " doesn\[CloseCurlyQuote]t evaluate for some reason.  I label those points \
\[OpenCurlyDoubleQuote]problems\[CloseCurlyDoubleQuote] and generally skip \
them.  This is something we can improve (figure out why they don\
\[CloseCurlyQuote]t evaluate, and/or make sure those points aren\
\[CloseCurlyQuote]t crucial to correct interpolation."
}], "Subsection",
 CellChangeTimes->{{3.608479977611597*^9, 3.608479979107318*^9}, {
  3.608480227302121*^9, 3.608480270925755*^9}, {3.6084803086557426`*^9, 
  3.60848032215154*^9}}],

Cell[CellGroupData[{

Cell["Here is \[Psi]good", "Subsection",
 CellChangeTimes->{{3.608310727599464*^9, 3.608310733014524*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"make\[Psi]good", ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rmin", ",", "rmax", ",", "rimin", ",", "rimax", ",", "dri", ",", 
       "rgrid", ",", "\[Psi]tab", ",", "\[Psi]int", ",", "rchange", ",", 
       "largerexp", ",", "\[Psi]good", ",", "\[Psi]plot"}], "}"}], ",", "\n", 
     "\n", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "MBHnorm"}],
         "}"}], "]"}], ";", "\n", "\n", 
      RowBox[{"rmin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{"rmax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{"rimin", "=", 
       RowBox[{
        RowBox[{"Log10", "[", "rmin", "]"}], "-", "5"}]}], ";", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"rimax", "=", 
         RowBox[{
          RowBox[{"Log10", "[", "rmax", "]"}], "+", "5"}]}], ";"}], " ", 
       "*)"}], "\n", 
      RowBox[{"rimax", "=", 
       RowBox[{
        RowBox[{"Log10", "[", "rmax", "]"}], "+", "7"}]}], ";", "\n", 
      RowBox[{"dri", "=", ".03"}], ";", "\n", 
      RowBox[{"rgrid", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"10", "^", "rii"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"rii", ",", " ", "rimin", ",", "rimax", ",", "dri"}], 
          "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Psi]tab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"\[Psi]", "[", "r", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "rgrid"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Psi]int", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"Log10", "[", "rgrid", "]"}], ",", 
            RowBox[{"Log10", "[", "\[Psi]tab", "]"}]}], "]"}], ",", "2"}], 
         "]"}], "]"}]}], ";", "\n", 
      RowBox[{"rchange", "=", 
       RowBox[{"rgrid", "[", 
        RowBox[{"[", 
         RowBox[{"Length", "[", "rgrid", "]"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "<", "2"}], ",", 
          RowBox[{"largerexp", "=", 
           RowBox[{"1", "-", "\[Beta]"}]}], ",", 
          RowBox[{"largerexp", "=", 
           RowBox[{"-", "1"}]}]}], "]"}], ";"}], " ", "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "<", "2"}], ",", 
        RowBox[{"Print", "[", "\"\<Warning! \[Beta]<2\>\"", "]"}], ",", 
        RowBox[{"largerexp", "=", 
         RowBox[{"-", "1"}]}]}], "]"}], ";", "\n", 
      RowBox[{"\[Psi]good", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]tab", "[", 
               RowBox[{"[", "1", "]"}], "]"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"rgrid", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/", "#"}], ")"}]}], ",", 
             RowBox[{"#", "<", 
              RowBox[{"rgrid", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"\[Psi]int", "[", 
               RowBox[{"Log10", "[", "#", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"rgrid", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<=", "rchange"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Psi]tab", "[", 
               RowBox[{"[", 
                RowBox[{"Length", "[", "rgrid", "]"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "/", "rchange"}], ")"}], "^", "largerexp"}]}], 
             ",", 
             RowBox[{"#", ">", "rchange"}]}], "}"}]}], "}"}], "]"}], "]"}]}], 
      ";", "\n", "\n", 
      RowBox[{"\[Psi]plot", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"LogLogPlot", "[", 
          RowBox[{
           RowBox[{"\[Psi]good", "[", "r", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", 
             RowBox[{"10", "^", 
              RowBox[{"-", "12"}]}], ",", 
             RowBox[{"10", "^", "12"}]}], "}"}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<r\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\[Psi]:\>\"", ",", "\[Alpha]", ",", "\[Beta]", ",", 
                "\[Gamma]", ",", "MBHnorm"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         "\n", "\t", 
         RowBox[{"ListLogLogPlot", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Riffle", "[", 
             RowBox[{"rgrid", ",", "\[Psi]tab"}], "]"}], ",", "2"}], "]"}], 
          "]"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Save", "[", 
         RowBox[{"plotfilename", ",", "\[Psi]plot"}], "]"}], ";"}], " ", 
       "*)"}], "\n", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"plotfilename", "<>", "\"\<psi.eps\>\""}], ",", 
        "\[Psi]plot"}], "]"}], ";", "\n", "\n", "\[Psi]good"}]}], "\n", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5685590087825613`*^9, 3.568559028106009*^9}, {
   3.568559747048715*^9, 3.568559774154688*^9}, 3.608310643997159*^9, 
   3.6083107404062233`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Here is ggood", "Subsection",
 CellChangeTimes->{{3.6083107625975437`*^9, 3.608310764509656*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox["\[IndentingNewLine]", "Subsection"], 
  RowBox[{
   RowBox[{
    RowBox[{"makeggood", "[", "\[Psi]good_", "]"}], ":=", 
    RowBox[{"Module", "[", "\n", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rmin", ",", "rmax", ",", "eimin", ",", "eimax", ",", "dei", ",", 
        "problems", ",", "Egrid", ",", "gtab", ",", "gtabtemp", ",", 
        "gtabholes", ",", "Egridholes", ",", "gint", ",", "Echange", ",", 
        "largerexp", ",", "ggood", ",", "gplot"}], "}"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{
         "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "MBHnorm"}], "}"}],
         "]"}], ";", "\n", "\n", 
       RowBox[{"rmin", "=", 
        RowBox[{"Min", "[", 
         RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
       RowBox[{"rmax", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
       RowBox[{"eimax", "=", 
        RowBox[{
         RowBox[{"Log10", "[", 
          RowBox[{
           RowBox[{"(", "MBHnorm", ")"}], "/", "rmin"}], "]"}], "+", "5"}]}], 
       ";", "\n", 
       RowBox[{"eimin", "=", 
        RowBox[{
         RowBox[{"Log10", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Menc", "[", "rmax", "]"}], ")"}], "/", "rmax"}], "]"}], 
         "-", "3"}]}], ";", "\n", 
       RowBox[{"dei", "=", ".1"}], ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"{", 
         RowBox[{"eimax", ",", "eimin"}], "}"}], "]"}], ";", "\n", 
       RowBox[{"Egrid", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"10", "^", "eii"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"eii", ",", " ", "eimin", ",", "eimax", ",", "dei"}], 
           "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"gtab", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", " ", 
          RowBox[{"{", 
           RowBox[{"E", ",", "Egrid"}], "}"}]}], "]"}]}], ";", "\n", 
       RowBox[{"problems", "=", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "Egrid", "]"}], ";", " ", 
       RowBox[{"Print", "[", "gtab", "]"}], ";", " ", 
       RowBox[{"Print", "[", "problems", "]"}], ";", "\n", "\n", 
       RowBox[{"Do", "[", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Mod", "[", 
              RowBox[{"i", ",", "100"}], "]"}], "==", "0"}], ",", 
            RowBox[{"Print", "[", "i", "]"}]}], "]"}], ";", "\n", 
          RowBox[{"gtabtemp", "=", 
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{"Egrid", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "\[Psi]good"}], "]"}]}], 
          ";", "\n", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "gtabtemp", "]"}], "==", "Real"}], ",", 
            RowBox[{
             RowBox[{"gtab", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", "gtabtemp"}], ",", "Null", 
            ",", 
            RowBox[{"problems", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"problems", ",", 
               RowBox[{"{", "i", "}"}]}], "]"}]}]}], "]"}], ";"}], "\n", ",", 
         
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "Egrid", "]"}]}], "}"}]}], "]"}], ";", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"When", " ", "Mathematica", " ", 
          RowBox[{"can", "'"}], "t", " ", "evaluate", " ", "it"}], ",", " ", 
         RowBox[{
          RowBox[{
          "the", " ", "Head", " ", "is", " ", "\"\<Re\>\"", " ", "for", " ", 
           "some", " ", 
           RowBox[{"reason", ".", " ", "Re"}]}], " ", "==", " ", 
          RowBox[{
          "Real", " ", "counts", " ", "as", " ", "neither", " ", "true", " ", 
           "nor", " ", "false"}]}], ",", " ", 
         RowBox[{"for", " ", "some", " ", "reason"}]}], " ", "*)"}], "\n", 
       RowBox[{"Print", "[", "\"\<Done with gtab\>\"", "]"}], ";", "\n", "\n", 
       RowBox[{"If", " ", "[", 
        RowBox[{
         RowBox[{"problems", "!=", " ", 
          RowBox[{"{", "}"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<problems:\>\"", ",", " ", "problems"}], "]"}], ";", 
          RowBox[{"problems", "=", 
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", "0", "}"}], ",", "problems", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", "Egrid", "]"}], "+", "1"}], "}"}]}], 
            "]"}]}], ";", "\n", 
          RowBox[{"gtabholes", "=", 
           RowBox[{"{", "}"}]}], ";", "\n", 
          RowBox[{"Egridholes", "=", 
           RowBox[{"{", "}"}]}], ";", "\n", 
          RowBox[{"Do", "[", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"gtabholes", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"gtabholes", ",", 
                RowBox[{"gtab", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"problems", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ";;", 
                   RowBox[{
                    RowBox[{"problems", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], 
                  "]"}], "]"}]}], "]"}]}], ";", "\n", 
             RowBox[{"Egridholes", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"Egridholes", ",", 
                RowBox[{"Egrid", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"problems", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ";;", 
                   RowBox[{
                    RowBox[{"problems", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], 
                  "]"}], "]"}]}], "]"}]}], ";"}], "\n", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{
               RowBox[{"Length", "[", "problems", "]"}], "-", "1"}]}], 
             "}"}]}], "]"}], ";"}], "\n", ",", " ", "\n", " ", 
         RowBox[{"(*", " ", "else", " ", "*)"}], "\n", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<no problems\>\"", "]"}], ";", "\n", 
          RowBox[{"gtabholes", "=", "gtab"}], ";", "\n", 
          RowBox[{"Egridholes", "=", "Egrid"}], ";"}]}], "\n", "]"}], ";", 
       "\n", "\n", 
       RowBox[{"gint", "=", 
        RowBox[{"Interpolation", "[", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Riffle", "[", 
            RowBox[{
             RowBox[{"Log10", "[", "Egridholes", "]"}], ",", 
             RowBox[{"Log10", "[", "gtabholes", "]"}]}], "]"}], ",", "2"}], 
          "]"}], "]"}]}], ";", "\n", 
       RowBox[{"Echange", "=", 
        RowBox[{"Egridholes", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "Egridholes", "]"}], "]"}], "]"}]}], ";", 
       "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Beta]", "<", "2"}], ",", 
           RowBox[{"largerexp", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Beta]", "+", "1"}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "-", 
             RowBox[{"1", "/", "2"}]}]}], ",", 
           RowBox[{"largerexp", "=", 
            RowBox[{"\[Beta]", "+", 
             RowBox[{"1", "/", "2"}]}]}]}], "]"}], ";"}], " ", "*)"}], "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"\[Beta]", "<", "2"}], ",", 
         RowBox[{"Print", "[", "\"\<Warning: \[Beta]<2!!\>\"", "]"}], ",", 
         RowBox[{"largerexp", "=", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"1", "/", "2"}]}]}]}], "]"}], ";", "\n", "\n", 
       RowBox[{"ggood", "=", 
        RowBox[{"Function", "[", 
         RowBox[{"Piecewise", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"gtabholes", "[", 
                RowBox[{"[", "1", "]"}], "]"}], " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "/", 
                  RowBox[{"Egridholes", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", 
                RowBox[{"(", "largerexp", ")"}]}]}], ",", 
              RowBox[{"#", "<", 
               RowBox[{"Egridholes", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"10", "^", 
               RowBox[{"gint", "[", 
                RowBox[{"Log10", "[", "#", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"Egridholes", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<=", 
               "Echange"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"gtabholes", "[", 
                RowBox[{"[", 
                 RowBox[{"Length", "[", "Egridholes", "]"}], "]"}], "]"}], 
               " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "/", "Echange"}], ")"}], "^", 
                RowBox[{"(", 
                 RowBox[{"\[Gamma]", "-", 
                  RowBox[{"1", "/", "2"}]}], ")"}]}]}], ",", 
              RowBox[{"#", ">", "Echange"}]}], "}"}]}], "}"}], "]"}], "]"}]}],
        ";", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<Echange = \>\"", ",", " ", "Echange", ",", " ", 
         "\"\< and \[Gamma]-1/2 = \>\"", ",", " ", 
         RowBox[{"\[Gamma]", "-", 
          RowBox[{"1", "/", "2"}]}]}], "]"}], ";", "\n", "\n", 
       RowBox[{"gplot", "=", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"LogLogPlot", "[", 
           RowBox[{
            RowBox[{"ggood", "[", "EE", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"EE", ",", 
              RowBox[{"10", "^", 
               RowBox[{"-", "12"}]}], ",", 
              RowBox[{"10", "^", "12"}]}], "}"}], ",", 
            RowBox[{"AxesLabel", "->", 
             RowBox[{"{", 
              RowBox[{"\"\<E\>\"", ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<g:\>\"", ",", "\[Alpha]", ",", "\[Beta]", ",", 
                 "\[Gamma]", ",", "MBHnorm"}], "}"}]}], "}"}]}]}], "]"}], ",",
           "\n", 
          RowBox[{"ListLogLogPlot", "[", 
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"Riffle", "[", 
              RowBox[{"Egridholes", ",", "gtabholes"}], "]"}], ",", "2"}], 
            "]"}], "]"}]}], "]"}]}], ";", "\n", "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Save", "[", 
          RowBox[{"plotfilename", ",", " ", "gplot"}], "]"}], ";"}], " ", 
        "*)"}], "\n", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"plotfilename", "<>", "\"\<g.eps\>\""}], ",", "gplot"}], 
        "]"}], ";", "\n", "\n", "ggood"}]}], "\n", "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.5685590087825613`*^9, 3.568559028106009*^9}, {
   3.568559747048715*^9, 3.568559774154688*^9}, 3.608310643997159*^9, {
   3.6083107404062233`*^9, 3.608310783114745*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Here is mathcalGgood", "Subsection",
 CellChangeTimes->{{3.608310796679904*^9, 3.608310807476223*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"makemathcalGgood", "[", 
      RowBox[{"\[Psi]good_", ",", "ggood_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rmin", ",", "rmax", ",", "eimin", ",", "eimax", ",", "dei", ",", 
         "problems", ",", "problemsends", ",", "Emcgrid", ",", "mathcalGtab", 
         ",", "mathcalGtabtemp", ",", "mathcalGtabholes", ",", "Emcgridholes",
          ",", "mathcalGint", ",", "Emcchange", ",", "largerexp", ",", 
         "mathcalGgood", ",", "mathcalGplot"}], "}"}], ",", "\n", "\n", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<working on mathcalGgood\>\"", "]"}], ";", 
        "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{
          "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "MBHnorm"}], 
          "}"}], "]"}], ";", "\n", 
        RowBox[{"rmin", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
        RowBox[{"rmax", " ", "=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
        RowBox[{"eimax", "=", 
         RowBox[{
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"(", "MBHnorm", ")"}], "/", "rmin"}], "]"}], "+", "3"}]}],
         ";", "\n", 
        RowBox[{"eimin", "=", 
         RowBox[{
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Menc", "[", "rmax", "]"}], ")"}], "/", "rmax"}], "]"}], 
          "-", "4"}]}], ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"eimax", "=", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"(", "MBHnorm", ")"}], "/", "rmin"}], "]"}], "+", 
            "2"}]}], ";"}], " ", "*)"}], "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"eimin", "=", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Menc", "[", "rmax", "]"}], ")"}], "/", "rmax"}], 
            "]"}]}], ";"}], " ", "*)"}], "\n", 
        RowBox[{"dei", "=", ".1"}], ";", "\n", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{"eimax", " ", "<", " ", "eimin"}], ",", " ", 
          RowBox[{
          "Print", "[", "\"\<PROBLEM in makemathcalggood:  eimax < eimin\>\"",
            "]"}]}], "]"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"eimax", ",", "eimin"}], "}"}], "]"}], ";", "\n", 
        RowBox[{"Emcgrid", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"10", "^", "eii"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"eii", ",", " ", "eimin", ",", "eimax", ",", "dei"}], 
            "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"mathcalGtab", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"EE", ",", "Emcgrid"}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"Print", "[", "Emcgrid", "]"}], ";", "\n", 
        RowBox[{"Print", "[", "mathcalGtab", "]"}], ";", "\n", 
        RowBox[{"problems", "=", 
         RowBox[{"{", "}"}]}], ";", "\n", 
        RowBox[{"(*", "\n", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"Emcgrid", "[", 
            RowBox[{"[", "100", "]"}], "]"}], "]"}], ";", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{"ggood", "[", 
            RowBox[{"Emcgrid", "[", 
             RowBox[{"[", "100", "]"}], "]"}], "]"}], "]"}], ";", "\n", 
          RowBox[{"Print", "[", 
           RowBox[{"mathcalG", "[", 
            RowBox[{
             RowBox[{"Emcgrid", "[", 
              RowBox[{"[", "100", "]"}], "]"}], ",", "\[Psi]good", ",", 
             "ggood"}], "]"}], "]"}], ";"}], " ", "*)"}], "\n", 
        RowBox[{"Do", "[", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"mathcalGtabtemp", "=", 
            RowBox[{"mathcalG", "[", 
             RowBox[{
              RowBox[{"Emcgrid", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\[Psi]good", ",", 
              "ggood"}], "]"}]}], ";", "\n", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{"NumericQ", "[", "mathcalGtabtemp", "]"}], ",", " ", 
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Emcgrid", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "\"\<    \>\"", ",",
                "mathcalGtabtemp"}], "]"}], ",", " ", 
             RowBox[{"Print", "[", 
              RowBox[{"Emcgrid", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}], ";", "\n", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "mathcalGtabtemp", "]"}], "==", "Real"}], 
             ",", 
             RowBox[{
              RowBox[{"mathcalGtab", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "mathcalGtabtemp"}], ",", 
             "Null", ",", 
             RowBox[{"problems", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"problems", ",", 
                RowBox[{"{", "i", "}"}]}], "]"}]}]}], "]"}], ";", "\n", 
           RowBox[{"If", " ", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"i", ",", "100"}], "]"}], "==", "0"}], ",", 
             RowBox[{"Print", "[", "i", "]"}]}], "]"}], ";"}], "\n", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Print", "[", "i", "]"}], ";"}], " ", "*)"}], "\n", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "Emcgrid", "]"}]}], "}"}]}], "\n", "]"}], 
        ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"When", " ", "Mathematica", " ", 
           RowBox[{"can", "'"}], "t", " ", "evaluate", " ", "it"}], ",", " ", 
          
          RowBox[{
           RowBox[{
           "the", " ", "Head", " ", "is", " ", "\"\<Re\>\"", " ", "for", " ", 
            "some", " ", 
            RowBox[{"reason", ".", " ", "Re"}]}], " ", "==", " ", 
           RowBox[{
           "Real", " ", "counts", " ", "as", " ", "neither", " ", "true", " ",
             "nor", " ", "false"}]}], ",", " ", 
          RowBox[{"for", " ", "some", " ", 
           RowBox[{"reason", ".", "  ", "I"}], " ", "could", " ", "use", " ", 
           "the", " ", "function", " ", "NumericalQ", " ", "here", " ", 
           "instead", " ", "actually"}], ",", " ", 
          RowBox[{
          "instead", " ", "of", " ", "checking", " ", "the", " ", "Head"}]}], 
         " ", "*)"}], 
        RowBox[{"Print", "[", "\"\<Done with mathcalGtab\>\"", "]"}], ";", 
        "\n", "\n", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{"problems", "!=", " ", 
           RowBox[{"{", "}"}]}], ",", "\n", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<problems:\>\"", ",", " ", "problems"}], "]"}], ";", 
           "\n", 
           RowBox[{"problemsends", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", "problems", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Length", "[", "Emcgrid", "]"}], "+", "1"}], "}"}]}], 
             "]"}]}], ";", 
           RowBox[{"mathcalGtabholes", "=", 
            RowBox[{"{", "}"}]}], ";", "\n", 
           RowBox[{"Emcgridholes", "=", 
            RowBox[{"{", "}"}]}], ";", "\n", "\n", 
           RowBox[{"Do", "[", "\n", 
            RowBox[{
             RowBox[{
              RowBox[{"mathcalGtabholes", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"mathcalGtabholes", ",", 
                 RowBox[{"mathcalGtab", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"problemsends", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ";;", 
                    RowBox[{
                    RowBox[{"problemsends", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], 
                   "]"}], "]"}]}], "]"}]}], ";", "\n", 
              RowBox[{"Emcgridholes", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"Emcgridholes", ",", 
                 RowBox[{"Emcgrid", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"problemsends", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ";;", 
                    RowBox[{
                    RowBox[{"problemsends", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], 
                   "]"}], "]"}]}], "]"}]}], ";"}], "\n", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "problemsends", "]"}], "-", "1"}]}], 
              "}"}]}], "]"}]}], "\n", ",", "\n", 
          RowBox[{"(*", " ", "else", " ", "*)"}], "\n", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no problems\>\"", "]"}], ";", "\n", 
           RowBox[{"mathcalGtabholes", "=", "mathcalGtab"}], ";", "\n", 
           RowBox[{"Emcgridholes", "=", "Emcgrid"}], ";"}]}], "\n", "]"}], 
        ";", "\n", "\n", 
        RowBox[{"mathcalGint", "=", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"Log10", "[", "Emcgridholes", "]"}], ",", 
              RowBox[{"Log10", "[", "mathcalGtabholes", "]"}]}], "]"}], ",", 
            "2"}], "]"}], "]"}]}], ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Taking", " ", "the", " ", "log", " ", "makes", " ", "the", " ", 
          "interpolation", " ", "work", " ", "better", " ", "if", " ", 
          "there", " ", "are", " ", "missing", " ", "points"}], " ", "*)"}], 
        "\n", 
        RowBox[{"Emcchange", "=", 
         RowBox[{"Emcgridholes", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "Emcgridholes", "]"}], "]"}], "]"}]}], ";", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "<", "2"}], ",", 
            RowBox[{"largerexp", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Beta]", "-", "2"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "-", "1"}]}], ",", 
            RowBox[{"largerexp", "=", 
             RowBox[{"\[Beta]", "-", "3"}]}]}], "]"}], ";"}], " ", "*)"}], 
        "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "<", "2"}], ",", 
          RowBox[{"Print", "[", "\"\<Warning!  \[Beta]<2\>\"", "]"}], ",", 
          RowBox[{"largerexp", "=", 
           RowBox[{"\[Beta]", "-", "4"}]}]}], "]"}], ";", "\n", "\n", 
        RowBox[{"mathcalGgood", "=", 
         RowBox[{"Function", "[", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"mathcalGtabholes", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/", 
                   RowBox[{"Emcgridholes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", 
                 RowBox[{"(", "largerexp", ")"}]}]}], ",", 
               RowBox[{"#", "<", 
                RowBox[{"Emcgridholes", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"mathcalGint", "[", 
                 RowBox[{"Log10", "[", "#", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"Emcgridholes", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<=", 
                "Emcchange"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"mathcalGtabholes", "[", 
                 RowBox[{"[", 
                  RowBox[{"Length", "[", "Emcgridholes", "]"}], "]"}], "]"}], 
                " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/", "Emcchange"}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"\[Gamma]", "-", "4"}], ")"}]}]}], ",", 
               RowBox[{"#", ">", "Emcchange"}]}], "}"}]}], "}"}], "]"}], 
          "]"}]}], ";", "\n", "\n", "\n", 
        RowBox[{"mathcalGplot", "=", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"LogLogPlot", "[", 
            RowBox[{
             RowBox[{"mathcalGgood", "[", "EE", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"EE", ",", 
               RowBox[{"10", "^", 
                RowBox[{"-", "12"}]}], ",", 
               RowBox[{"10", "^", "12"}]}], "}"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<mathcalG:\>\"", ",", "\[Alpha]", ",", "\[Beta]", ",", 
                  "\[Gamma]", ",", "MBHnorm"}], "}"}]}], "}"}]}]}], "]"}], 
           ",", "\n", 
           RowBox[{"ListLogLogPlot", "[", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Riffle", "[", 
               RowBox[{"Emcgridholes", ",", "mathcalGtabholes"}], "]"}], ",", 
              "2"}], "]"}], "]"}]}], "]"}]}], ";", "\n", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Save", "[", 
           RowBox[{"plotfilename", ",", " ", "mathcalGplot"}], "]"}], ";"}], 
         " ", "*)"}], "\n", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"plotfilename", "<>", "\"\<mathcalG.eps\>\""}], ",", 
          "mathcalGplot"}], "]"}], ";", "\n", "\n", "mathcalGgood"}]}], "\n", 
      "]"}]}], ";"}], "\n", "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{{3.5685590087825613`*^9, 3.568559028106009*^9}, {
   3.568559747048715*^9, 3.568559774154688*^9}, 3.608310643997159*^9, {
   3.6083107404062233`*^9, 3.608310792185013*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Here is Mencgood", "Subsection",
 CellChangeTimes->{{3.608310829059978*^9, 3.6083108338759527`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeMencgood", ":=", 
   RowBox[{"Module", "[", "\n", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rmin", ",", "rmax", ",", "rimin", ",", "rimax", ",", "dri", ",", 
       "rgrid", ",", "Menctab", ",", "Mencint", ",", "rchange", ",", 
       "Mencgood", ",", "Mencplot"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "MBHnorm"}],
         "}"}], "]"}], ";", "\n", "\n", 
      RowBox[{"rmin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{"rmax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{"rimin", "=", 
       RowBox[{
        RowBox[{"Log10", "[", "rmin", "]"}], "-", "5"}]}], ";", "\n", 
      RowBox[{"rimax", "=", 
       RowBox[{
        RowBox[{"Log10", "[", "rmax", "]"}], "+", "5"}]}], ";", "\n", 
      RowBox[{"dri", "=", ".03"}], ";", "\n", 
      RowBox[{"rgrid", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"10", "^", "rii"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"rii", ",", " ", "rimin", ",", "rimax", ",", "dri"}], 
          "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Menctab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Menc", "[", "r", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"r", ",", "rgrid"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Mencint", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"Log10", "[", "rgrid", "]"}], ",", 
            RowBox[{"Log10", "[", "Menctab", "]"}]}], "]"}], ",", "2"}], 
         "]"}], "]"}]}], ";", "\n", 
      RowBox[{"rchange", "=", 
       RowBox[{"rgrid", "[", 
        RowBox[{"[", 
         RowBox[{"Length", "[", "rgrid", "]"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"Mencgood", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Menctab", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "/", 
                 RowBox[{"rgrid", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"2", "-", "\[CapitalGamma]"}], ")"}]}]}], ",", 
             RowBox[{"#", "<", 
              RowBox[{"rgrid", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"Mencint", "[", 
               RowBox[{"Log10", "[", "#", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"rgrid", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<=", "rchange"}]}],
             "}"}], ",", "\n", "\n", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Which", "[", "\n", 
              RowBox[{
               RowBox[{"\[Beta]", ">", "2"}], ",", 
               RowBox[{"Menctab", "[", 
                RowBox[{"[", 
                 RowBox[{"Length", "[", "rgrid", "]"}], "]"}], "]"}], ",", 
               "\n", 
               RowBox[{"\[Beta]", "<", "2"}], ",", 
               RowBox[{
                RowBox[{"Menctab", "[", 
                 RowBox[{"[", 
                  RowBox[{"Length", "[", "rgrid", "]"}], "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/", "rchange"}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"3", "-", "\[Beta]"}], ")"}]}]}], ",", "\n", 
               RowBox[{"\[Beta]", "==", "2"}], ",", 
               RowBox[{
                RowBox[{"Menctab", "[", 
                 RowBox[{"[", 
                  RowBox[{"Length", "[", "rgrid", "]"}], "]"}], "]"}], "+", 
                RowBox[{"4", "\[Pi]", " ", 
                 RowBox[{"\[Rho]", "[", "rchange", "]"}], " ", 
                 RowBox[{"rchange", "^", "3"}], " ", 
                 RowBox[{"Log", "[", 
                  RowBox[{"#", "/", "rchange"}], "]"}]}]}]}], "\n", "]"}], 
             ",", 
             RowBox[{"#", ">", "rchange"}]}], "}"}]}], "}"}], "]"}], "]"}]}], 
      ";", "\n", "\n", 
      RowBox[{"Mencplot", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"LogLogPlot", "[", 
          RowBox[{
           RowBox[{"Mencgood", "[", "r", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"r", ",", 
             RowBox[{"10", "^", 
              RowBox[{"-", "12"}]}], ",", 
             RowBox[{"10", "^", "12"}]}], "}"}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<r\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Menc:\>\"", ",", "\[Alpha]", ",", "\[Beta]", ",", 
                "\[Gamma]", ",", "MBHnorm"}], "}"}]}], "}"}]}]}], "]"}], ",", 
         "\n", 
         RowBox[{"ListLogLogPlot", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Riffle", "[", 
             RowBox[{"rgrid", ",", "Menctab"}], "]"}], ",", "2"}], "]"}], 
          "]"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Save", "[", 
         RowBox[{"plotfilename", ",", " ", "Mencplot"}], "]"}], ";"}], " ", 
       "*)"}], "\n", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"plotfilename", "<>", "\"\<Menc.eps\>\""}], ",", "Mencplot"}],
        "]"}], ";", "\n", "\n", "Mencgood"}]}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.568559066879621*^9, 3.608310839903116*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Here is fgood", "Subsection",
 CellChangeTimes->{{3.608310853523435*^9, 3.608310855434531*^9}}],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"makefgood", "[", 
      RowBox[{"Mencgood_", ",", "\[Psi]good_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "rmin", ",", "rmax", ",", "eimin", ",", "eimax", ",", "dei", ",", 
         "problems", ",", "Egrid", ",", "ftab", ",", "ftabtemp", ",", 
         "ftabholes", ",", "Egridholes", ",", "fint", ",", "Echange", ",", 
         "largerexp", ",", "fgood", ",", "fplot"}], "}"}], ",", "\n", "\n", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{
          "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "MBHnorm"}], 
          "}"}], "]"}], ";", "\n", 
        RowBox[{"rmin", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
        RowBox[{"rmax", " ", "=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
        RowBox[{"eimax", "=", 
         RowBox[{
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"(", "MBHnorm", ")"}], "/", "rmin"}], "]"}], "+", "5"}]}],
         ";", "\n", 
        RowBox[{"eimin", "=", 
         RowBox[{
          RowBox[{"Log10", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Menc", "[", "rmax", "]"}], ")"}], "/", "rmax"}], "]"}], 
          "-", "3"}]}], ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"eimax", "=", 
           RowBox[{
            RowBox[{"Log10", "[", 
             RowBox[{
              RowBox[{"(", "MBHnorm", ")"}], "/", "rmin"}], "]"}], "+", 
            "2"}]}], ";"}], " ", "*)"}], "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"eimin", "=", 
           RowBox[{"Log10", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Menc", "[", "rmax", "]"}], ")"}], "/", "rmax"}], 
            "]"}]}], ";"}], " ", "*)"}], "\n", 
        RowBox[{"dei", "=", ".03"}], ";", "\n", 
        RowBox[{"Print", "[", 
         RowBox[{"{", 
          RowBox[{"eimax", ",", "eimin"}], "}"}], "]"}], ";", "\n", 
        RowBox[{"Egrid", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"10", "^", "eii"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"eii", ",", " ", "eimin", ",", "eimax", ",", "dei"}], 
            "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"ftab", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", " ", 
           RowBox[{"{", 
            RowBox[{"EE", ",", "Egrid"}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"problems", "=", 
         RowBox[{"{", "}"}]}], ";", "\n", "\n", 
        RowBox[{"Do", "[", "\n", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"i", ",", "100"}], "]"}], "==", "0"}], ",", 
             RowBox[{"Print", "[", "i", "]"}]}], "]"}], ";", "\n", 
           RowBox[{"ftabtemp", "=", 
            RowBox[{"f", "[", 
             RowBox[{
              RowBox[{"Egrid", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "Mencgood", ",", 
              "\[Psi]good"}], "]"}]}], ";", "\n", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "ftabtemp", "]"}], "==", "Real"}], ",", 
             RowBox[{
              RowBox[{"ftab", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "=", "ftabtemp"}], ",", "Null",
              ",", 
             RowBox[{"problems", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"problems", ",", 
                RowBox[{"{", "i", "}"}]}], "]"}]}]}], "]"}], ";"}], "\n", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "Egrid", "]"}]}], "}"}]}], "]"}], ";", 
        "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"When", " ", "Mathematica", " ", 
           RowBox[{"can", "'"}], "t", " ", "evaluate", " ", "it"}], ",", " ", 
          
          RowBox[{
           RowBox[{
           "the", " ", "Head", " ", "is", " ", "\"\<Re\>\"", " ", "for", " ", 
            "some", " ", 
            RowBox[{"reason", ".", " ", "Re"}]}], " ", "==", " ", 
           RowBox[{
           "Real", " ", "counts", " ", "as", " ", "neither", " ", "true", " ",
             "nor", " ", "false"}]}], ",", " ", 
          RowBox[{"for", " ", "some", " ", "reason"}]}], " ", "*)"}], "\n", 
        RowBox[{"Print", "[", "\"\<Done with ftab\>\"", "]"}], ";", "\n", 
        "\n", 
        RowBox[{"If", " ", "[", 
         RowBox[{
          RowBox[{"problems", "!=", " ", 
           RowBox[{"{", "}"}]}], ",", "\n", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<problems:\>\"", ",", " ", "problems"}], "]"}], ";", 
           "\n", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<E problems:\>\"", ",", " ", 
             RowBox[{"Egrid", "[", 
              RowBox[{"[", "problems", "]"}], "]"}]}], "]"}], ";", "\n", 
           RowBox[{"problems", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"{", "0", "}"}], ",", "problems", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Length", "[", "Egrid", "]"}], "+", "1"}], "}"}]}], 
             "]"}]}], ";", "\n", 
           RowBox[{"ftabholes", "=", 
            RowBox[{"{", "}"}]}], ";", "\n", 
           RowBox[{"Egridholes", "=", 
            RowBox[{"{", "}"}]}], ";", "\n", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ftabholes", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"ftabholes", ",", 
                 RowBox[{"ftab", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"problems", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ";;", 
                    RowBox[{
                    RowBox[{"problems", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], 
                   "]"}], "]"}]}], "]"}]}], ";", "\n", 
              RowBox[{"Egridholes", "=", 
               RowBox[{"Join", "[", 
                RowBox[{"Egridholes", ",", 
                 RowBox[{"Egrid", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"problems", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "+", "1"}], ";;", 
                    RowBox[{
                    RowBox[{"problems", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "1"}], "]"}], "]"}], "-", "1"}]}], 
                   "]"}], "]"}]}], "]"}]}], ";"}], "\n", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "problems", "]"}], "-", "1"}]}], 
              "}"}]}], "]"}]}], "\n", ",", "\n", " ", 
          RowBox[{"(*", " ", "else", " ", "*)"}], "\n", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<no problems\>\"", "]"}], ";", "\n", 
           RowBox[{"ftabholes", "=", "ftab"}], ";", "\n", 
           RowBox[{"Egridholes", "=", "Egrid"}], ";"}]}], "\n", "]"}], ";", 
        "\n", "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"Negative", "[", "ftabholes", "]"}], ",", "True"}], 
            "]"}], ">", "0"}], ",", "\n", "\t", 
          RowBox[{
          "Print", "[", 
           "\"\<\n*****************************************************\n\
*************** f is negative!!!!!!!! **************\n\
*****************************************************\n\n\>\"", "]"}]}], 
         "]"}], ";", "\n", "\n", "\n", 
        RowBox[{"fint", "=", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Riffle", "[", 
             RowBox[{
              RowBox[{"Log10", "[", "Egridholes", "]"}], ",", 
              RowBox[{"Log10", "[", "ftabholes", "]"}]}], "]"}], ",", "2"}], 
           "]"}], "]"}]}], ";", "\n", 
        RowBox[{"Echange", "=", 
         RowBox[{"Egridholes", "[", 
          RowBox[{"[", 
           RowBox[{"Length", "[", "Egridholes", "]"}], "]"}], "]"}]}], ";", 
        "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"\[Beta]", "<", "2"}], ",", 
            RowBox[{"largerexp", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Beta]", "+", "1"}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"\[Beta]", "-", "1"}], ")"}]}], "-", 
              RowBox[{"3", "/", "2"}]}]}], ",", 
            RowBox[{"largerexp", "=", 
             RowBox[{"\[Beta]", "-", 
              RowBox[{"1", "/", "2"}]}]}]}], "]"}], ";"}], " ", "*)"}], "\n", 
        
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "<", "2"}], ",", 
          RowBox[{"Print", "[", "\"\<Warning!! \[Beta]<2\>\"", "]"}], ",", 
          RowBox[{"largerexp", "=", 
           RowBox[{"\[Beta]", "-", 
            RowBox[{"3", "/", "2"}]}]}]}], "]"}], ";", "\n", "\n", 
        RowBox[{"fgood", "=", 
         RowBox[{"Function", "[", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", "\n", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"ftabholes", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/", 
                   RowBox[{"Egridholes", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", 
                 RowBox[{"(", "largerexp", ")"}]}]}], ",", 
               RowBox[{"#", "<", 
                RowBox[{"Egridholes", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"fint", "[", 
                 RowBox[{"Log10", "[", "#", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"Egridholes", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<=", 
                "Echange"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"ftabholes", "[", 
                 RowBox[{"[", 
                  RowBox[{"Length", "[", "Egridholes", "]"}], "]"}], "]"}], 
                " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"#", "/", "Echange"}], ")"}], "^", 
                 RowBox[{"(", 
                  RowBox[{"\[Gamma]", "-", 
                   RowBox[{"3", "/", "2"}]}], ")"}]}]}], ",", 
               RowBox[{"#", ">", "Echange"}]}], "}"}]}], "}"}], "]"}], 
          "]"}]}], ";", "\n", "\n", 
        RowBox[{"fplot", "=", 
         RowBox[{"Show", "[", 
          RowBox[{
           RowBox[{"LogLogPlot", "[", 
            RowBox[{
             RowBox[{"fgood", "[", "E", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"E", ",", 
               RowBox[{"10", "^", 
                RowBox[{"-", "12"}]}], ",", 
               RowBox[{"10", "^", "12"}]}], "}"}], ",", 
             RowBox[{"AxesLabel", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<E\>\"", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<f:\>\"", ",", "\[Alpha]", ",", "\[Beta]", ",", 
                  "\[Gamma]", ",", "MBHnorm"}], "}"}]}], "}"}]}]}], "]"}], 
           ",", "\n", 
           RowBox[{"ListLogLogPlot", "[", 
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Riffle", "[", 
               RowBox[{"Egridholes", ",", "ftabholes"}], "]"}], ",", "2"}], 
             "]"}], "]"}]}], "]"}]}], ";", "\n", "\n", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Save", "[", 
           RowBox[{"plotfilename", ",", " ", "fplot"}], "]"}], ";"}], " ", 
         "*)"}], "\n", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"plotfilename", "<>", "\"\<f.eps\>\""}], ",", "fplot"}], 
         "]"}], ";", "\n", "\n", "fgood"}]}], " ", "\n", "\n", "]"}]}], ";"}],
    " ", "\n", "\n", "\n"}]}]], "Input",
 CellChangeTimes->{3.568559066879621*^9, 3.608310839903116*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Here is Jc2good", "Subsection",
 CellChangeTimes->{{3.608310865202993*^9, 3.608310867434742*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeJc2good", "[", 
    RowBox[{"Mencgood_", ",", "\[Psi]good_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rmin", ",", "rmax", ",", "eimin", ",", "eimax", ",", "dei", ",", 
       "Egrid", ",", "Jc2tab", ",", "Jc2int", ",", "Echange", ",", 
       "largerexp", ",", "Jc2good", ",", "Jc2plot"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "MBHnorm"}],
         "}"}], "]"}], ";", "\n", "\n", 
      RowBox[{"rmin", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{"rmax", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"rh", ",", "1"}], "]"}]}], ";", "\n", 
      RowBox[{"eimax", "=", 
       RowBox[{
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{"(", "MBHnorm", ")"}], "/", "rmin"}], "]"}], "+", "3"}]}], 
      ";", "\n", 
      RowBox[{"eimin", "=", 
       RowBox[{
        RowBox[{"Log10", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Menc", "[", "rmax", "]"}], ")"}], "/", "rmax"}], "]"}], 
        "-", "3"}]}], ";", "\n", 
      RowBox[{"dei", "=", ".01"}], ";", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"{", 
        RowBox[{"eimax", ",", "eimin"}], "}"}], "]"}], ";", "\n", 
      RowBox[{"Egrid", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"10", "^", "eii"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"eii", ",", " ", "eimin", ",", "eimax", ",", "dei"}], 
          "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Jc2tab", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Jc2", "[", 
          RowBox[{"eii", ",", "Mencgood", ",", "\[Psi]good"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"eii", ",", "Egrid"}], "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"Jc2int", "=", 
       RowBox[{"Interpolation", "[", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"Riffle", "[", 
           RowBox[{
            RowBox[{"Log10", "[", "Egrid", "]"}], ",", 
            RowBox[{"Log10", "[", "Jc2tab", "]"}]}], "]"}], ",", "2"}], "]"}],
         "]"}]}], ";", "\n", 
      RowBox[{"Echange", "=", 
       RowBox[{"Egrid", "[", 
        RowBox[{"[", 
         RowBox[{"Length", "[", "Egrid", "]"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Beta]", "<", "2"}], ",", 
          RowBox[{"largerexp", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"3", "-", "\[Beta]"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Beta]"}], ")"}]}]}], ",", 
          RowBox[{"largerexp", "=", 
           RowBox[{"-", "1"}]}]}], "]"}], ";"}], " ", "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[Beta]", "<", "2"}], ",", 
        RowBox[{"Print", "[", "\"\<Warning! \[Beta]<2\>\"", "]"}], ",", 
        RowBox[{"largerexp", "=", 
         RowBox[{"-", "1"}]}]}], "]"}], ";", "\n", 
      RowBox[{"Jc2good", "=", 
       RowBox[{"Function", "[", 
        RowBox[{"Piecewise", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Jc2tab", "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "/", 
                 RowBox[{"Egrid", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", 
               "largerexp"}]}], ",", 
             RowBox[{"#", "<", 
              RowBox[{"Egrid", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"10", "^", 
              RowBox[{"Jc2int", "[", 
               RowBox[{"Log10", "[", "#", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Egrid", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<=", "#", "<=", "Echange"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Jc2tab", "[", 
               RowBox[{"[", 
                RowBox[{"Length", "[", "Egrid", "]"}], "]"}], "]"}], " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"#", "/", "Echange"}], ")"}], "^", 
               RowBox[{"-", "1"}]}]}], ",", 
             RowBox[{"#", ">", "Echange"}]}], "}"}]}], "}"}], "]"}], "]"}]}], 
      ";", "\n", "\n", 
      RowBox[{"Jc2plot", "=", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"LogLogPlot", "[", 
          RowBox[{
           RowBox[{"Jc2good", "[", "EE", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"EE", ",", 
             RowBox[{"10", "^", 
              RowBox[{"-", "12"}]}], ",", 
             RowBox[{"10", "^", "12"}]}], "}"}], ",", 
           RowBox[{"AxesLabel", "->", 
            RowBox[{"{", 
             RowBox[{"\"\<E\>\"", ",", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\\!\\(\\*SuperscriptBox[\\\"Jc\\\", \\\"2\\\"]\\):\>\"", 
                ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", 
                "MBHnorm"}], "}"}]}], "}"}]}]}], "]"}], ",", "\n", 
         RowBox[{"ListLogLogPlot", "[", 
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Riffle", "[", 
             RowBox[{"Egrid", ",", "Jc2tab"}], "]"}], ",", "2"}], "]"}], 
          "]"}]}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Save", "[", 
         RowBox[{"plotfilename", ",", " ", "Jc2plot"}], "]"}], ";"}], " ", 
       "*)"}], "\n", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"plotfilename", "<>", "\"\<Jc2.eps\>\""}], ",", "Jc2plot"}], 
       "]"}], ";", "\n", "\n", "Jc2good"}]}], "\n", "]"}]}], "\n", "\n", "\n",
   "\n", "\n", "\n", "\n"}]], "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{740, 752},
WindowMargins->{{21, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 22, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 261, 5, 123, "Title"],
Cell[CellGroupData[{
Cell[708, 24, 101, 1, 67, "Section"],
Cell[CellGroupData[{
Cell[834, 29, 181, 4, 35, "Subsection"],
Cell[1018, 35, 4518, 116, 403, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5573, 156, 329, 6, 35, "Subsection"],
Cell[5905, 164, 282, 6, 26, "Text"],
Cell[6190, 172, 2359, 77, 88, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8586, 254, 206, 4, 35, "Subsection"],
Cell[8795, 260, 1733, 51, 73, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10565, 316, 229, 5, 35, "Subsection"],
Cell[10797, 323, 4706, 127, 373, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15540, 455, 336, 6, 65, "Subsection"],
Cell[15879, 463, 25060, 630, 1678, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40976, 1098, 147, 3, 34, "Subsection"],
Cell[41126, 1103, 8989, 226, 823, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50164, 1335, 316, 6, 67, "Section"],
Cell[50483, 1343, 757, 13, 110, "Subsection"],
Cell[51243, 1358, 625, 12, 57, "Subsection"],
Cell[CellGroupData[{
Cell[51893, 1374, 106, 1, 27, "Subsection"],
Cell[52002, 1377, 5806, 152, 493, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57845, 1534, 103, 1, 35, "Subsection"],
Cell[57951, 1537, 11639, 290, 988, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69627, 1832, 108, 1, 35, "Subsection"],
Cell[69738, 1835, 14653, 351, 1378, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84428, 2191, 106, 1, 35, "Subsection"],
Cell[84537, 2194, 5934, 150, 508, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90508, 2349, 101, 1, 35, "Subsection"],
Cell[90612, 2352, 12720, 317, 1198, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103369, 2674, 103, 1, 35, "Subsection"],
Cell[103475, 2677, 6090, 161, 583, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

